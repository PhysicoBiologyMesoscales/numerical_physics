(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16420,        419]
NotebookOptionsPosition[     15237,        393]
NotebookOutlinePosition[     15641,        409]
CellTagsIndexPosition[     15598,        406]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"S", " ", "Matrix", " ", "computation"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.954427952985155*^9, 3.954427966384939*^9}, {
  3.9544280021430845`*^9, 3.95442801881892*^9}},
 CellLabel->
  "(Debug) In[1]:=",ExpressionUUID->"723b8cce-4306-485f-802d-732eda8f3953"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"I", "*", "\[Omega]"}], "+", 
    RowBox[{"D", "*", 
     RowBox[{"k", "^", "2"}]}], "+", 
    RowBox[{"n", "^", "2"}], "+", 
    RowBox[{"U", "*", 
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{"n", ",", "0"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "[", "n_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"\[Rho]", "/", "Pi"}], "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"D", "*", 
      RowBox[{"k", "^", "2"}]}], "+", 
     RowBox[{"n", "^", "2"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.954344215162573*^9, 3.95434432778262*^9}, {
   3.954344359428698*^9, 3.9543444336603374`*^9}, {3.954344478723762*^9, 
   3.954344491385723*^9}, {3.9543445222261963`*^9, 3.9543445266494446`*^9}, 
   3.954344808638484*^9, 3.9543873538324676`*^9, {3.9544220072217913`*^9, 
   3.9544220089711175`*^9}, 3.9544223973625417`*^9, {3.9544279433237095`*^9, 
   3.9544279491692824`*^9}, {3.9544281739885225`*^9, 3.9544281779342246`*^9}},
 CellLabel->
  "(Debug) In[2]:=",ExpressionUUID->"2c353282-81fa-412a-a42e-b4b51f3933d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]", "[", 
    RowBox[{"0", ",", " ", "0", ",", "m_"}], "]"}], ":=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]", "[", 
   RowBox[{"N_", ",", " ", "p_", ",", " ", "m_"}], "]"}], ":=", 
  RowBox[{"Which", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "<", "0"}], ",", " ", "0", ",", "\[IndentingNewLine]", 
    RowBox[{"p", ">", "N"}], ",", " ", "0", ",", "\[IndentingNewLine]", 
    "True", ",", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]", "[", 
        RowBox[{
         RowBox[{"N", "-", "1"}], ",", " ", "p", ",", " ", 
         RowBox[{"m", "-", "1"}]}], "]"}], "+", 
       RowBox[{"\[Alpha]", "[", 
        RowBox[{
         RowBox[{"N", "-", "1"}], ",", " ", 
         RowBox[{"p", "-", "1"}], ",", " ", 
         RowBox[{"m", "+", "1"}]}], "]"}]}], ")"}], "/", 
     RowBox[{"\[Beta]", "[", "m", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9543868876952667`*^9, 3.9543868927646728`*^9}, {
   3.954387046644979*^9, 3.954387060699063*^9}, {3.95438715928446*^9, 
   3.954387320060594*^9}, {3.954387416690837*^9, 3.954387418282911*^9}, {
   3.95438752634385*^9, 3.9543875754865437`*^9}, {3.9543876768362427`*^9, 
   3.9543876793421693`*^9}, {3.9543877141522202`*^9, 
   3.9543877755703278`*^9}, {3.954388004625641*^9, 3.9543880342187943`*^9}, {
   3.954388098617849*^9, 3.954388121280204*^9}, {3.954388157220826*^9, 
   3.9543882267616987`*^9}, {3.9543882753570743`*^9, 
   3.9543883023082275`*^9}, {3.95438836343834*^9, 3.9543883641259203`*^9}, {
   3.9543884161339073`*^9, 3.954388451113042*^9}, 3.954435691177135*^9},
 CellLabel->
  "(Debug) In[4]:=",ExpressionUUID->"ceca9442-dccc-4775-baa2-4a2859d418b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S", "[", 
   RowBox[{"p_", ",", " ", "n_", ",", " ", "m_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"assumptions", ",", " ", "sum"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"assumptions", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Element", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Omega]", ",", " ", "D", ",", " ", "U", ",", " ", "k"}], 
           "}"}], ",", " ", "Reals"}], "]"}], ",", " ", 
        RowBox[{"Element", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"n", ",", " ", "m"}], "}"}], ",", " ", "Integers"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sum", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"I", "*", "l"}], ")"}], "^", "p"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Beta]", "[", "n", "]"}], "*", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"\[Beta]", "[", "m", "]"}], "]"}]}], ")"}]}], "*", 
       RowBox[{"k", "^", "p"}], "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"n", ",", " ", 
            RowBox[{"m", "-", "p", "+", 
             RowBox[{"2", "*", "u"}]}]}], "]"}], "*", "\[IndentingNewLine]", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"p", "-", "q"}], ")"}]}], "\[IndentingNewLine]", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"A", "[", 
                 RowBox[{"m", "+", "q", "-", 
                  RowBox[{"2", "*", "l"}]}], "]"}], "*", 
                RowBox[{"\[Alpha]", "[", 
                 RowBox[{
                  RowBox[{"p", "-", "q"}], ",", " ", 
                  RowBox[{"u", "+", "l", "-", "q"}], ",", " ", 
                  RowBox[{"m", "+", "q", "-", 
                   RowBox[{"2", "*", "l"}]}]}], "]"}], "*", 
                RowBox[{"Conjugate", "[", 
                 RowBox[{"\[Alpha]", "[", 
                  RowBox[{"q", ",", " ", "l", ",", " ", 
                   RowBox[{"m", "+", "q", "-", 
                    RowBox[{"2", "*", "l"}]}]}], "]"}], "]"}]}], ",", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"l", ",", " ", "0", ",", " ", "q"}], "}"}]}], "]"}]}],
             ",", " ", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"q", ",", " ", "0", ",", "p"}], "}"}]}], "]"}]}], ",", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"u", ",", " ", "0", ",", " ", "p"}], "}"}]}], "]"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"ComplexExpand", "[", "sum", "]"}], ",", " ", 
       RowBox[{"Assumptions", "->", "assumptions"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9544216453131866`*^9, 3.954421919767167*^9}, 
   3.954428169624885*^9, {3.954435047648239*^9, 3.954435069361371*^9}, {
   3.954435355802142*^9, 3.9544355491180716`*^9}, 3.9544356295273614`*^9, {
   3.9544937703523197`*^9, 3.9544937757772255`*^9}, 3.954493958896948*^9, {
   3.9544961105726967`*^9, 3.9544961113606777`*^9}, {3.9544964868106365`*^9, 
   3.954496509703806*^9}, {3.954497000476101*^9, 3.954497002011593*^9}, {
   3.9544970341395607`*^9, 3.95449703612076*^9}, {3.954497079668829*^9, 
   3.9544970808285656`*^9}},
 CellLabel->
  "(Debug) In[86]:=",ExpressionUUID->"ebbc853b-4cd3-4873-b5c0-d92f02d03d6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntegrateWithPoles", "[", 
   RowBox[{"p_", ",", " ", "n_", ",", " ", "m_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "poles", ",", " ", "poleIsPositive", ",", " ", "upperPlanePoles", ",", 
      " ", "integral", ",", " ", "assumptions"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Spnm", "=", 
      RowBox[{"S", "[", 
       RowBox[{"p", ",", "n", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"assumptions", "=", 
      RowBox[{"{", 
       RowBox[{"Element", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[Omega]", ",", " ", "D", ",", " ", "k", ",", " ", "n", ",", " ", 
           "\[Rho]", ",", " ", "U"}], "}"}], ",", " ", "Reals"}], "]"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"poles", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
          RowBox[{"Assumptions", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Element", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"k", ",", "D", ",", " ", "U"}], "}"}], ",", " ", 
               "Reals"}], "]"}], ",", " ", 
             RowBox[{"D", ">", "0"}]}], "}"}]}]}], "]"}], "&"}], "/@", 
       RowBox[{"FunctionPoles", "[", 
        RowBox[{"Spnm", ",", " ", "\[Omega]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"poleIsPositive", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"Positive", "[", 
           RowBox[{"#", "/", "I"}], "]"}], ",", " ", 
          RowBox[{"Assumptions", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"D", ">", "0"}], ",", " ", 
             RowBox[{"k", ">", "0"}], ",", " ", 
             RowBox[{"U", ">", "0"}]}], "}"}]}]}], "]"}], "&"}], "/@", 
       "poles"}]}], " ", ";", "\[IndentingNewLine]", 
     RowBox[{"upperPlanePoles", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"poles", ",", " ", "poleIsPositive"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"integral", " ", "=", " ", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"2", "*", "I", "*", "Pi", "*", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Residue", "[", 
             RowBox[{"Spnm", ",", " ", 
              RowBox[{"{", 
               RowBox[{"\[Omega]", ",", " ", "#"}], "}"}]}], "]"}], "&"}], "/@",
            "upperPlanePoles"}], "]"}]}], ",", " ", 
        RowBox[{"Assumptions", "->", "assumptions"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "integral"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.954434728828277*^9, 3.954434947969454*^9}, {
   3.9544906248885517`*^9, 3.954490633262333*^9}, 3.95449181986767*^9, {
   3.9544935176216965`*^9, 3.954493542668562*^9}},
 CellLabel->
  "(Debug) In[87]:=",ExpressionUUID->"95aa58b4-7df5-42a2-b27a-8c53d4526e94"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"p", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Smat", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"IntegrateWithPoles", "[", 
      RowBox[{"p", ",", " ", "n", ",", "m"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", " ", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", " ", "p"}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"-", "n"}], ",", "n"}], "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Smat", "/.", 
      RowBox[{"U", "->", 
       RowBox[{
        RowBox[{"k", "^", "2"}], "*", "\[Rho]", "*", "V"}]}]}], ")"}], "/", 
    RowBox[{"\[Rho]", "^", "2"}]}], ")"}], "/.", 
  RowBox[{"\[Rho]", "->", "0"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"MatrixForm", "[", "Smat", "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdymkow3EAxvG/Y5Sj/q4XY8kcicyRq1xNEQnTeIGUtVKTMLUkTYikKG1N
5nhB7iNHOZY0mjleuF7ItWEiI6OFN1j4P78XT58Xz5crrhVW2FMUFcwMWqPZ
dfL61/SrjMh6OHZ12wZ/1yzt0F7j1Q0Dc5QK0vHmtdBoyd+G765hJ7DB5nQJ
Rc7mnj5GGfdOAVUrhyOQ/jDNwIi28SVoDLWsQskCexO2u70RraV7evgZXbID
l7Nst6QTxJvgRVe1GU71Kr/hVlMSS81o8m0mimIv3OFTxyNxyHIXAE8MjYGw
TF2dALfm5ETZRlAq5OdO8KEtvlgKHzwriUNCDdXPOBfEcoAHKn8aStfDiaIU
vR+kz4+J3pznPNjALhdAjnBUR3TY2SW/IfMMFhtDDNBq13oPC8yTZniq4H3B
7OtkovRFKRhgDO71KITdYzFVkJ8fVQMl4p8WmKGOa4UBXs3D0HH2lUiXlW5C
fWoN0XYm24WLk3n7sCiN+oPLOi1rkNGN1+kCcz9URPmKjwccPrrxgY5+UVzI
mU4k/gPrxy7P
  "],
 CellLabel->
  "(Debug) In[109]:=",ExpressionUUID->"4ca43931-dc06-4ebd-ad88-0e73cc73f671"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "k", " ", "l", " ", "V"}], 
      RowBox[{"D", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "D", " ", 
          SuperscriptBox["k", "2"]}]}], ")"}]}]], ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.954494125430195*^9, 3.954495031260624*^9, 3.954495162580023*^9, 
   3.954495194099642*^9, {3.954495266351919*^9, 3.9544952958149624`*^9}, 
   3.9544955015771446`*^9, {3.954496126818289*^9, 3.9544961537628193`*^9}, {
   3.9544963464019146`*^9, 3.9544963701831646`*^9}, {3.9544965126632843`*^9, 
   3.9544965227582912`*^9}, 3.9544967758896503`*^9, {3.9544970087919445`*^9, 
   3.954497043121641*^9}, {3.954497076662569*^9, 3.954497091650423*^9}, 
   3.9544975290377903`*^9, 3.9544975827710476`*^9, 3.954497621922415*^9, {
   3.954497699529356*^9, 3.954497712670849*^9}, 3.954497802355978*^9},
 CellLabel->
  "(Debug) Out[111]=",ExpressionUUID->"67ddf50d-11e2-a34e-be40-30e23c294721"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"p", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Smat", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"IntegrateWithPoles", "[", 
     RowBox[{"p", ",", " ", "n", ",", "m"}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"n", ",", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", " ", "p"}], "]"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"m", ",", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"-", "n"}], ",", "n"}], "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.954494590029114*^9, 3.954494701569887*^9}, {
  3.9544949244547977`*^9, 3.954494945966646*^9}, {3.9544949830237064`*^9, 
  3.9544949886251545`*^9}, {3.9544952555667133`*^9, 3.9544952573748455`*^9}, {
  3.9544955997865295`*^9, 3.9544956309748135`*^9}, {3.9544956995710983`*^9, 
  3.954495708072981*^9}},
 CellLabel->
  "(Debug) In[44]:=",ExpressionUUID->"a9a0286b-b4e3-d949-bef3-e887380b1ac7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   FractionBox[
    RowBox[{"D", " ", 
     SuperscriptBox["k", "2"], " ", "\[Rho]"}], 
    RowBox[{
     RowBox[{"D", " ", 
      SuperscriptBox["k", "2"]}], "+", "U"}]], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.954494989114746*^9, {3.9544956067173386`*^9, 3.9544956322551537`*^9}, {
   3.9544957013403797`*^9, 3.954495708448679*^9}},
 CellLabel->
  "(Debug) Out[45]=",ExpressionUUID->"0040309a-aeae-bb43-b740-e9de4f3d3f6f"]
}, Open  ]]
},
WindowSize->{958.5, 1011},
WindowMargins->{{-5.25, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (March 14, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b73ec637-2186-4f8c-9afb-11ba1e24b134"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 314, 6, 42, "Input",ExpressionUUID->"723b8cce-4306-485f-802d-732eda8f3953"],
Cell[875, 28, 1158, 28, 61, "Input",ExpressionUUID->"2c353282-81fa-412a-a42e-b4b51f3933d8"],
Cell[2036, 58, 1776, 38, 137, "Input",ExpressionUUID->"ceca9442-dccc-4775-baa2-4a2859d418b0"],
Cell[3815, 98, 3882, 92, 289, "Input",ExpressionUUID->"ebbc853b-4cd3-4873-b5c0-d92f02d03d6b"],
Cell[7700, 192, 3172, 81, 213, "Input",ExpressionUUID->"95aa58b4-7df5-42a2-b27a-8c53d4526e94"],
Cell[CellGroupData[{
Cell[10897, 277, 1715, 44, 99, "Input",ExpressionUUID->"4ca43931-dc06-4ebd-ad88-0e73cc73f671"],
Cell[12615, 323, 1104, 24, 66, "Output",ExpressionUUID->"67ddf50d-11e2-a34e-be40-30e23c294721"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13756, 352, 984, 23, 61, "Input",ExpressionUUID->"a9a0286b-b4e3-d949-bef3-e887380b1ac7"],
Cell[14743, 377, 478, 13, 63, "Output",ExpressionUUID->"0040309a-aeae-bb43-b740-e9de4f3d3f6f"]
}, Open  ]]
}
]
*)

